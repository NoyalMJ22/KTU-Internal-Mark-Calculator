<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>KTU Internal Mark Calculator</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <h1>KTU Internal Mark Calculator</h1>
    <form id="markForm">
        <label>Name: <input type="text" name="name" required></label><br>

        <label>Test 1: <input type="number" step="0.1" name="test1" required></label>
        <label>Out of: <input type="number" name="test1_total" required></label><br>

        <label>Test 2: <input type="number" step="0.1" name="test2" required></label>
        <label>Out of: <input type="number" name="test2_total" required></label><br>

        <label>Assignment 1: <input type="number" step="0.1" name="assignment1" required></label>
        <label>Out of: <input type="number" name="assignment1_total" required></label><br>

        <label>Assignment 2: <input type="number" step="0.1" name="assignment2" required></label>
        <label>Out of: <input type="number" name="assignment2_total" required></label><br>

        <label>Attendance: <input type="range" name="attendance" min="0" max="100" value="75" id="attendanceRange">
            <span id="attendanceValue">75%</span>
        </label><br>

        <button type="submit">Calculate</button>
    </form>

    <div id="result"></div>

    <script>
        const range = document.getElementById("attendanceRange");
        const valueLabel = document.getElementById("attendanceValue");
        range.addEventListener("input", () => {
            valueLabel.textContent = `${range.value}%`;
        });

        document.getElementById("markForm").addEventListener("submit", async function(e) {
            e.preventDefault();
            const form = new FormData(this);
            const data = Object.fromEntries(form.entries());

            const response = await fetch("/calculate", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            });

            const result = await response.json();
            const resultDiv = document.getElementById("result");
            if (result.status === "success") {
                resultDiv.textContent = result.result;
                resultDiv.style.color = "green";
            } else {
                resultDiv.textContent = result.message;
                resultDiv.style.color = "red";
            }
        });
    </script>
</body>
</html>
